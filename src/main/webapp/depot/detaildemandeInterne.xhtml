<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets" 
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">
    <h:head>
        <title>Detail Demande Interne</title>
    </h:head>
    <h:body>
        <ui:composition template="Template.xhtml">
            <ui:define name="arborescence">
                <h:outputText value="Demande > Consultation DA > Détail Demande Interne" style="color:#000066; font-size: 14px;  font-family: Times New Roman, Georgia, Serif; margin-left: -920px;"/>
            </ui:define>
            <ui:define name="content">
                <p:blockUI block="form" widgetVar="block">
                    Chargement<br /> <h:graphicImage value="../images/loading.gif"/>
                </p:blockUI>
                <h:form id="form">
                   
                    <p:panel header="Détail de la demande Interne N° #{detailDemandeMb.DA.numDemande}" class="without-border">
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="form-horizontal">
                                    <div class="row">
                                        <div class="col-lg-4 col-lg-offset-1">
                                            <div class="form-group">
                                                <p:outputLabel value="Chantier: "/>
                                                <c:if test="#{detailDemandeMb.DA.etatDA.etat != 'Brouillon'}">
                                                    <p:inputText class="form-control" value="#{detailDemandeMb.DA.chantier.code}"/>
                                                </c:if>
                                                <c:if test="#{detailDemandeMb.DA.etatDA.etat == 'Brouillon'}">
                                                    <p:selectOneMenu required="true" requiredMessage="champ obligatoire" value="#{detailDemandeMb.idChantier}"
                                                                     filter="true" filterMatchMode="contains">
                                                        <f:selectItem /> 
                                                        <f:selectItems value="#{chantier.chantiers}" var="c" itemLabel="#{c.code}" itemValue="#{c.id}" />
                                                    </p:selectOneMenu>
                                                </c:if>
                                            </div>
                                            
                                            <div class="form-group">
                                                <p:outputLabel value="Atelier: "/>
                                                <c:if test="#{detailDemandeMb.DA.etatDA.etat != 'Brouillon'}">
                                                    <p:inputText class="form-control" value="#{detailDemandeMb.DA.atelier.code}"/>
                                                </c:if>
                                                <c:if test="#{detailDemandeMb.DA.etatDA.etat == 'Brouillon'}">
                                                            
                                    <p:selectOneMenu required="true" requiredMessage="champ obligatoire" value="#{detailDemandeMb.idAtelier}" filter="true" filterMatchMode="contains">
                                        <f:selectItem /> 
                                       <f:selectItems value="#{chantier.ateliers}" var="a" itemLabel="#{a.code}" itemValue="#{a.id}" />
                                    </p:selectOneMenu>
                                                </c:if>
                                            </div>
                                            
                                            <div class="form-group">
                                                <p:outputLabel value="Date de livraison souhaitée: "/>


                                                <c:if test= "#{detailDemandeMb.DA.etatDA.etat == 'Brouillon'}">
                                                    <p:calendar pattern="dd/MM/yyyy" mindate="#{constanteMb.maxDate}" 
                                                                class="form-control" style="padding: 0px 0px 0px 0px;border: 0px solid #ccc;display: flex"
                                                                showOn="button" id="date" value="#{detailDemandeMb.DA.dateLivraisonSouhaitee}" /> 
                                                </c:if>

                                                <c:if test= "#{detailDemandeMb.DA.etatDA.etat != 'Brouillon'}">
                                                    <p:inputText class="form-control" value="#{constanteMb.getDateFormatFR(detailDemandeMb.DA.dateLivraisonSouhaitee)}" readonly = "true" />
                                                </c:if>

                                            </div>
                                            <div class="form-group">
                                                <p:outputLabel value="Demandeur: "/>
                                                <p:inputText class="form-control" value="#{detailDemandeMb.DA.demandeur.login}" readonly = "#{detailDemandeMb.DA.etatDA.etat != 'Brouillon' ? true : false }"/>
                                            </div>
                                        </div>
                                        <div class="col-lg-4 col-lg-offset-1">
                                
                                            <div class="form-group">
                                                <p:outputLabel value="Etat: "/>
                                                <p:inputText id="etatId" class="form-control" value="#{detailDemandeMb.DA.etatDA.etat}" readonly = "#{detailDemandeMb.DA.etatDA.etat != 'Brouillon' ? true : false }" />
                                            </div>
                                            <c:if test= "#{detailDemandeMb.disableIntervenant == false}"> 
                                                               <div class="form-group">
                                        <p:commandButton onstart="PF('block').show()" oncomplete="PF('block').hide()"  style="background-color: #0CD424;width: 120px" 
                                                         class="btn btn-switch active" value="Acceptée"
                                                         disabled="#{detailDemandeMb.disable1}" action="#{detailDemandeMb.accepteDA()}" update=":form"/>
                                        <p:outputLabel value=" "/>
                                           <p:commandButton onstart="PF('block').show()" oncomplete="PF('block').hide()" style="background-color: #E50627;width: 120px"
                                                         class="btn btn-switch active" value="Refusée"
                                                         disabled="#{detailDemandeMb.disable1}" action="#{detailDemandeMb.refuseDA()}" update=":form"/>
                                        
                                    </div>
                                            </c:if>      
                                            <div class="form-group">
                                                <p:outputLabel value="Commentaire: "/>
                                                <p:inputText class="form-control" value="#{detailDemandeMb.DA.comantaire}" readonly = "#{detailDemandeMb.DA.etatDA.etat != 'Brouillon' ? true : false }"/>
                                            </div>

                                            
                                        </div>
                                    </div>
                                    <div class="col-lg-2 col-lg-offset-4">
                                        <p:commandButton onstart="PF('block').show()" oncomplete="PF('block').hide()" 
                                                         class="btn btn-switch active" value="#{detailDemandeMb.valueButton}"
                                                         disabled="#{detailDemandeMb.disable}" action="#{detailDemandeMb.envoyerDA()}" update="@form, :form:etatId"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <hr/>
                        <p:messages id="msgsRe" closable="true" showDetail="true"/>
                        <div class="row">
                            <div class="col-lg-12">
                                <p:dataTable id="dmdAppr" value="#{detailDemandeMb.listArticle}" var="lda" sortBy="#{lda.designationDemandeur}"  >
                                    <f:facet name="header">
                                        <p:commandButton style="display: #{detailDemandeMb.disable==true ? 'none': 'block'}" id="addAr" value="Ajouter Article"
                                                         icon="ui-icon-plus" type="button" onclick="PF('add').show();"/>
                                    </f:facet>
                                    
                                    <p:column headerText="Désignation Demandeur">
                                        <h:outputText value="#{lda.designationDemandeur}"/>
                                    </p:column>
                                    <p:column headerText="Qte Demandé">
                                        <h:outputText value="#{lda.qte}"/>
                                    </p:column>
                                    <p:column headerText="Code Article">
                                        <h:outputText value="#{lda.artcile.codeArticle}"/>
                                    </p:column>

                                    <p:column headerText="Article">
                                       <h:outputText value="#{lda.artcile.designation}"/>
                                    </p:column>
                                    <p:column headerText="Engin">
                                        <h:outputText value="#{lda.engin.code} -- #{lda.engin.designation}"/>
                                    </p:column>  


                             

                                    <p:column headerText="Qte Article">
                                        <h:outputText value="#{lda.quantiteArticle}"/>
                                    </p:column>
                                    
                                    <p:column headerText="Qte Préparé">
                                        <h:outputText value="#{lda.quantitePrepare}"/>
                                    </p:column>
                                    <p:column headerText="Unité">
                                        <h:outputText value="#{lda.artcile.unite}"/>
                                    </p:column>
                                    <p:column headerText="Etat">
                                        <h:outputText value="#{lda.etatDA.etat}"/>
                                    </p:column>
                                    <p:column headerText="Actions" style=";width: 230px">
                                           
                                            <p:commandButton icon="ui-icon-arrowthickstop-1-s" action="#{detailDemandeMb.downloalImage1(lda.fileImport)}" ajax="false" >
							 </p:commandButton>
                                         <c:if test= "#{detailDemandeMb.disableIntervenant == false}"> 
                                        <p:commandButton icon="ui-icon-closethick" action="#{detailDemandeMb.refuseArt(lda)}" update=":form:dmdAppr" id="refus"    >
							 </p:commandButton>
                                                         <p:commandButton icon="ui-icon-check" action="#{detailDemandeMb.accepteArt(lda)}" update=":form:dmdAppr" id="accepte"   >
							 </p:commandButton>
                                        <p:commandButton icon="ui-icon-plusthick"  onclick="PF('addplus').show();" action="#{detailDemandeMb.recuperationArt(lda)}" id="addAr1" update=":addArti1" disabled="#{detailDemandeMb.disableadd}"   >
							 </p:commandButton>
                                       
                                        <p:commandButton icon="ui-icon-folder-open" title="show detail" action="#{detailDemandeMb.recuperationArtDeatil(lda)}" id="detailAr" update=":detailDA"   onclick="PF('detail').show();" disabled="#{detailDemandeMb.disableadd}"  >
							 </p:commandButton>
                                         </c:if>
                                        <p:commandButton onstart="PF('block').show()" oncomplete="PF('block').hide()" 
                                                         icon="ui-icon-trash" action="#{detailDemandeMb.deleteArticleDA()}" 
                                                         update=":form:dmdAppr" disabled="#{detailDemandeMb.disable}">
                                            <f:setPropertyActionListener value="#{lda}" target="#{detailDemandeMb.ADA}" />
                                            <p:confirm header="Confirmation" message="Voulez vous vraiment supprimer l'articleDA ?" />
                                        </p:commandButton>
                                        <p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
                                            <p:commandButton value="Oui" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" update=":form:dmdAppr, :form:msgsMR" />
                                            <p:commandButton value="Annuler" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close" update=":form:dmdAppr, :form:msgsMR"/>
                                        </p:confirmDialog>
                                    </p:column>
                                </p:dataTable>
                            </div>
                        </div>
                    </p:panel>
                </h:form>
                    <p:dialog header="Ajouter un Article" widgetVar="add" modal="true" closable="false"   >
                    
                    <h:form id="addArti"  enctype="multipart/form-data">
                        <p:commandButton id="annuller" style="float:right;height: 25px;width: 31px;padding-right: 10px;background-color: #F08080"  icon="ui-icon-closethick"
                                             value=" " action="#{detailDemandeMb.viderArtcileDialog()}" update=":addArti" onclick="PF('add').hide();"  />
                        <h:panelGrid columns="6" >
                            <h:outputText value="Article :"/>
                            <p:inputText value="#{detailDemandeMb.arti.codeArticle}" id="codeA">
                                <p:ajax update=":addArti" event="change" listener="#{detailDemandeMb.findArticle()}"/>
                            </p:inputText>
                            <p:commandButton icon="ui-icon-search" onclick="PF('search').show();"  /> 
                            <h:outputText value="Libellé :"/>
                            <h:outputText value="#{detailDemandeMb.arti.designation}"  id="quanA"/> 
                            <br/>
                            <h:outputText value="Unité :"/>
                            <h:outputText value="#{detailDemandeMb.arti.unite}" id="unite"/> 
                              
                            <br/> 
                            <h:outputText value="Designation :"/>
                            <p:inputText value="#{detailDemandeMb.designation}" label="Designation saisir "/><br/>
                            <h:outputText value="Quantité :"/>
                            <p:inputNumber  value="#{detailDemandeMb.quantite}" label="Quantité saisir "  />
                            <br/><h:outputText value="Largeur :"/>
                            <p:inputNumber  value="#{detailDemandeMb.largeur}" label="Largeur saisir "/><br/>
                            <h:outputText value="Longeur :"/>
                            <p:inputNumber  value="#{detailDemandeMb.longeur}" label="Longeur saisir "/>
                            <br/><h:outputText value="Hauteur :"/>
                            <p:inputNumber  value="#{detailDemandeMb.hauteur}" label="Haurteur saisir "/><br/>

                            <h:outputText value="Autre :"/>
                            <p:inputText value="#{detailDemandeMb.autre}" label="Autre saisir "/><br/>
                            <h:outputText value="Date fin Estimé D'utilisation :"/>
                            
                              <p:calendar mindate="#{constanteMb.minDate}" class="form-control" 
                                                showOn="button" pattern="dd/MM/yyyy"
                                                style="padding: 0px 0px 0px 0px;border: 0px solid #ccc; display: flex"
                                                id="date1" value="#{detailDemandeMb.dateMax}">
                              </p:calendar>
                            
                            <h:outputText value="  "/>
                            <h:outputText value="Fichier :"/>  <p:fileUpload 
                                           value="#{detailDemandeMb.uploadedFileQuitance}" mode="simple">
                            </p:fileUpload><h:outputText value=""/><h:outputText value=""/><h:outputText value=""/>
                            <br/><h:outputText value=""/><h:outputText value=""/><h:outputText value=""/><h:outputText value=""/>          
                        <br/>
                                                </h:panelGrid>
                         <p:commandButton id="btnOK" icon="ui-icon-plus" style="width:100%;float: right;background-color: #96E813;color: #101010;"
                                             value="Ajouter" action="#{detailDemandeMb.ajouterNouvelleDA1()}" 
                                             update=":form:dmdAppr,:form:btnDA,:addArti" onclick="PF('add').hide();" ajax="false"  />
                    </h:form>
                </p:dialog>
                <p:dialog header="Ajouter un Article" widgetVar="addplus" modal="true"   closable="false"  >
                    <h:form id="addArti1">
                        <p:commandButton id="annuller1" style="float:right;height: 25px;width: 31px;padding-right: 10px;background-color: #F08080"  icon="ui-icon-closethick"
                                             value=" " action="#{detailDemandeMb.viderArtcileDialog()}" update=":addArti1" onclick="PF('addplus').hide();"  />
                        <h:panelGrid columns="6" >
                            <h:outputText value="Article :"/>
                            <p:inputText value="#{detailDemandeMb.arti.codeArticle}" id="codeA1">
                                <p:ajax update=":addArti1" event="change" listener="#{detailDemandeMb.findArticle()}"/>
                            </p:inputText>
                            <p:commandButton icon="ui-icon-search" onclick="PF('search').show();"  /> 
                            <h:outputText value="Libellé :"/>
                            <h:outputText value="#{detailDemandeMb.arti.designation}"  /> 
                            
                            <br/>
                            <h:outputText value="Unité :"/>
                            <h:outputText value="#{detailDemandeMb.arti.unite}" id="unite1"/> 
                              
                            <br/> 
                            <h:outputText value="Designation :"/>
                            <p:inputText value="#{detailDemandeMb.designation}" label="Designation saisir "/><br/>
                            <h:outputText value="Quantité :"/>
                            <p:inputNumber  value="#{detailDemandeMb.quantite}" label="Quantité saisir "  readonly="true" />
                            <br/>
                           <h:outputText value="Date souhaitée:"/>
                           
                              <p:calendar mindate="#{constanteMb.minDate}" class="form-control" 
                                                showOn="button" pattern="dd/MM/yyyy"
                                                style="padding: 0px 0px 0px 0px;border: 0px solid #ccc; display: flex"
                                                id="date2" value="#{detailDemandeMb.dateSouhaite}">
                              </p:calendar> <br/>
                            <h:outputText value="Quantité Article :"/>
                            <p:inputNumber  value="#{detailDemandeMb.quantiteArticle}" label="Quantité saisir "  />
                            <br/>
                            <h:outputText value="Quantité Préparée :"/>
                            <p:inputNumber  value="#{detailDemandeMb.quantitePrepare}" label="Quantité saisir "  />
                            <br/><h:outputText value="Largeur :"/>
                            <p:inputNumber  value="#{detailDemandeMb.largeur}" label="Largeur saisir "/><br/>
                            <h:outputText value="Longeur :"/>
                            <p:inputNumber  value="#{detailDemandeMb.longeur}" label="Longeur saisir "/>
                            <br/><h:outputText value="Hauteur :"/>
                            <p:inputNumber  value="#{detailDemandeMb.hauteur}" label="Haurteur saisir "/><br/>

                            <h:outputText value="Autre :"/>
                            <p:inputText value="#{detailDemandeMb.autre}" label="Autre saisir "/><br/>
                            <h:outputText value="Date fin Estimé D'utilisation :"/>
                            
                              <p:calendar mindate="#{constanteMb.minDate}" class="form-control" 
                                                showOn="button" pattern="dd/MM/yyyy"
                                                style="padding: 0px 0px 0px 0px;border: 0px solid #ccc; display: flex"
                                                id="date1" value="#{detailDemandeMb.dateMax}">
                              </p:calendar>
                            
                            <h:outputText value="  "/>
                          <h:outputText value="Observation :"/>
                                                        <p:inputText value="#{detailDemandeMb.observation}" label="Observation saisir "/>
                                                       <br/>  <h:outputText value=""/><h:outputText value=""/>
                                                        <h:outputText value=""/><h:outputText value=""/><h:outputText value=""/>
                            <br/>    
                        <h:outputText value="Engin :"/>
                        <p:inputText value="#{detailDemandeMb.engin.code}" >
                            <p:ajax update=":addArti1" event="change" listener="#{detailDemandeMb.findEngin()}"/>
                            </p:inputText>
                            <p:commandButton icon="ui-icon-search" onclick="PF('search1').show();"  /> 
                            <h:outputText value="Libellé :"/>
                            <h:outputText value="#{detailDemandeMb.engin.designation}"  /> 
                            
                            
                                                </h:panelGrid>
                         <p:commandButton id="btnOK1" icon="ui-icon-plus" style="width:100%;float: right;background-color: #96E813;color: #101010;"
                                             value="Ajouter" action="#{detailDemandeMb.ajouterNouvelleDA()}" 
                                             update=":form:dmdAppr,:form:btnDA,:addArti1" onclick="PF('addplus').hide();" ajax="false"  />
                    </h:form>
                </p:dialog>
                
                <p:dialog header="Détail Article" widgetVar="detail" modal="true"  closable="false"  >
                    <h:form id="detailDA" enctype="multipart/form-data" >
                        <p:commandButton id="annuller" style="float:right;height: 25px;width: 31px;padding-right: 10px;background-color: #F08080"  icon="ui-icon-closethick"
                                             value=" " action="#{detailDemandeMb.viderArtcileDialog()}" update=":detailDA" onclick="PF('detail').hide();"  />
                        <h:panelGrid columns="6" >
                            <h:outputText value="Article :"/>
                            <p:inputText value="#{detailDemandeMb.arti.codeArticle}" id="codeA2">
                                <p:ajax update=":detailDA" event="change" listener="#{detailDemandeMb.findArticle()}"/>
                            </p:inputText>
                            <p:commandButton icon="ui-icon-search" onclick="PF('search').show();"  /> 
                            <h:outputText value="Libellé :"/>
                            <h:outputText value="#{detailDemandeMb.arti.designation}"  id="quanA2"/> 
                            <br/>
                            <h:outputText value="Unité :"/>
                            <h:outputText value="#{detailDemandeMb.arti.unite}" id="unite2"/> 
                              
                            <br/> 
                            <h:outputText value="Designation :"/>
                            <p:inputText value="#{detailDemandeMb.designation}" label="Designation saisir " readonly="true" /><br/>
                            <h:outputText value="Quantité :"/>
                            <p:inputNumber  value="#{detailDemandeMb.quantite}" label="Quantité saisir "  readonly="true" />
                            <br/>
                           <h:outputText value="Date souhaitée:"/>
                           
                              <p:calendar mindate="#{constanteMb.minDate}" class="form-control" 
                                                showOn="button" pattern="dd/MM/yyyy"
                                                style="padding: 0px 0px 0px 0px;border: 0px solid #ccc; display: flex"
                                                id="date2" value="#{detailDemandeMb.dateSouhaite}">
                              </p:calendar> <br/>
                            <h:outputText value="Quantité Article :"/>
                            <p:inputNumber  value="#{detailDemandeMb.quantiteArticle}" label="Quantité saisir "  />
                            <br/>
                            <h:outputText value="Quantité Préparée :"/>
                            <p:inputNumber  value="#{detailDemandeMb.quantitePrepare}" label="Quantité saisir "  />
                            <br/><h:outputText value="Largeur :"/>
                            <p:inputNumber  value="#{detailDemandeMb.largeur}" label="Largeur saisir "/><br/>
                            <h:outputText value="Longeur :"/>
                            <p:inputNumber  value="#{detailDemandeMb.longeur}" label="Longeur saisir "/>
                            <br/><h:outputText value="Hauteur :"/>
                            <p:inputNumber  value="#{detailDemandeMb.hauteur}" label="Haurteur saisir "/><br/>

                            <h:outputText value="Autre :"/>
                            <p:inputText value="#{detailDemandeMb.autre}" label="Autre saisir "/><br/>
                            <h:outputText value="Date fin Estimé D'utilisation :"/>
                            
                              <p:calendar mindate="#{constanteMb.minDate}" class="form-control" 
                                                showOn="button" pattern="dd/MM/yyyy"
                                                style="padding: 0px 0px 0px 0px;border: 0px solid #ccc; display: flex"
                                                id="date1" value="#{detailDemandeMb.dateMax}">
                              </p:calendar>
                            
                            <h:outputText value="  "/>
                                                        <h:outputText value="Observation :"/>
                                                        <p:inputText value="#{detailDemandeMb.observation}" label="Observation saisir "/>
                                                         <br/>  <br/>  <h:outputText value=""/><h:outputText value=""/>
                                                        <h:outputText value=""/><h:outputText value=""/><h:outputText value=""/>
                            <br/>    
                        <h:outputText value="Engin :"/>
                        <p:inputText value="#{detailDemandeMb.engin.code}" >
                            <p:ajax update=":detailDA" event="change" listener="#{detailDemandeMb.findEngin()}"/>
                            </p:inputText>
                            <p:commandButton icon="ui-icon-search" onclick="PF('search1').show();"  /> 
                            <h:outputText value="Libellé :"/>
                            <h:outputText value="#{detailDemandeMb.engin.designation}"  /> 
                                                </h:panelGrid>
                         <p:commandButton id="btnOK2"  style="width:100%;float: right;background-color: #96E813;color: #101010;"
                                          value="Modifier" action="#{detailDemandeMb.modifierNouvelleDA()}" 
                                             update=":form,:detailDA" oncomplete="PF('detail').hide();" ajax="false"  />
                    </h:form>
                </p:dialog>
         
                
                
                <p:dialog header="Article" modal="true" position="top" resizable="false"
                          widgetVar="search" width="50%" closable="true" >
                    <p:blockUI block="panelD" widgetVar="blockDialog">
                        Chargement<br /> <h:graphicImage value="../images/loading.gif"/>
                    </p:blockUI>
                    <p:panel id="panelD" style="overflow: auto; height: 500px"> 
                        <h:form id="dialog">
                            <div class="col-lg-8">
                               
                                <div class="row">
                                    <div class="col-lg-6">
                                        <h:outputText value="Famille 1 :"/>
                                    </div>
                                    <div class="col-lg-6">
                                        <p:selectOneMenu style="width:100%" id="fam1" value="#{detailDemandeMb.valueFam1}"
                                                         filter="true" filterMatchMode="contains">
                                            <f:selectItem /> 
                                            <f:selectItems value="#{detailDemandeMb.fam1}" var="c" itemLabel="#{c.famille}" itemValue="#{c.fam}" />
                                            <p:ajax onstart="PF('blockDialog').show()" oncomplete="PF('blockDialog').hide()" event="change" update="fam2,fam3" listener="#{detailDemandeMb.fam2ByFam1()}" /> 
                                        </p:selectOneMenu>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6">

                                        <h:outputText value="Famille 2 :"/>
                                    </div>

                                    <div class="col-lg-6">
                                        <p:selectOneMenu id="fam2" style="width:100%" value="#{detailDemandeMb.valueFam2}"
                                                         filter="true" filterMatchMode="contains"  >
                                            <f:selectItem /> 
                                            <f:selectItems value="#{detailDemandeMb.fam2}" var="c" itemLabel="#{c.famille}" itemValue="#{c.fam}" />
                                            <p:ajax onstart="PF('blockDialog').show()" oncomplete="PF('blockDialog').hide()" event="change" update="fam3" listener="#{detailDemandeMb.fam3ByFam2()}" /> 
                                        </p:selectOneMenu>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6">
                                        <h:outputText value="Famille 3 :"/>
                                    </div>
                                    <div class="col-lg-6">
                                        <p:selectOneMenu id="fam3" style="width:100%" value="#{detailDemandeMb.valueFam3}"
                                                         filter="true" filterMatchMode="contains" >
                                            <f:selectItem />
                                            <f:selectItems value="#{detailDemandeMb.fam3}" var="c" itemLabel="#{c.famille}" itemValue="#{c.fam}" />
                                        </p:selectOneMenu>
                                        <h:outputText/>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6">          
                                        <h:outputText value="Réference :"/>
                                    </div>
                                    <div class="col-lg-6">
                                        <p:inputText class="form-control" value="#{detailDemandeMb.reference}" />
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6">  
                                        <h:outputText value="Designation :"/>
                                    </div>
                                    <div class="col-lg-6">
                                        <p:inputText class="form-control" value="#{detailDemandeMb.des}"/>
                                    </div>
                                </div>
                            </div>

                            <div class="col-lg-12">
                                <br/>
                                <div class="pull-right">
                                    <p:commandButton onstart="PF('blockDialog').show()" oncomplete="PF('blockDialog').hide()"
                                                     value ="Rechercher" action="#{detailDemandeMb.articleByFam()}"
                                                     update="idArticle,:form:msgsRe"/>
                                </div>
                            </div>

                            <div class="col-lg-12">
                                <br/>
                                <p:dataTable id="idArticle" var="art" value="#{detailDemandeMb.listeArticle}" rowKey="#{art.id}"
                                             paginator="true" rows="10"  rowsPerPageTemplate="5,10,15"
                                             paginatorTemplate="{RowsPerPageDropdown} {FirstPageLink} {PreviousPageLink} {CurrentPageReport} {NextPageLink} {LastPageLink}"
                                             paginatorPosition="bottom" class="table table-bordered" >
                                    <p:column headerText="Code Article" filterBy="#{art.codeArticle}" filterFunction="#{filterMb.filterByX}">
                                        <h:outputText value="#{art.codeArticle}"/>
                                    </p:column>

                                    <p:column headerText="Désignation" filterBy="#{art.codeArticle}" filterFunction="#{filterMb.filterByX}">
                                        <h:outputText value="#{art.designation}"/>
                                    </p:column>

                                    <p:column headerText="Actions">
                                        <p:commandButton value="OK" update=":addArti,:addArti1,:detailDA"
                                                         onstart="PF('blockDialog').show();" 
                                                         oncomplete="PF('blockDialog').hide();PF('search').hide()" >
                                            <f:setPropertyActionListener value="#{art}" target="#{detailDemandeMb.arti}" />
                                        </p:commandButton>
                                    </p:column>
                                </p:dataTable>
                            </div>  
                        </h:form>                         
                    </p:panel>
                </p:dialog>
                
 
                               
                          <p:dialog header="Engin" modal="true" position="top" resizable="false"
                          widgetVar="search1" width="50%" closable="true" >
                    <p:blockUI block="panelD1" widgetVar="blockDialog1">
                        Chargement<br /> <h:graphicImage value="../images/loading.gif"/>
                    </p:blockUI>
                    <p:panel id="panelD1" style="overflow: auto; height: 500px"> 
                        <h:form id="dialog1">
                            <div class="col-lg-8">
                               

                                <div class="row">
                                    <div class="col-lg-6">          
                                        <h:outputText value="Réference :"/>
                                    </div>
                                    <div class="col-lg-6">
                                        <p:inputText class="form-control" value="#{detailDemandeMb.codee}" />
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6">  
                                        <h:outputText value="Designation :"/>
                                    </div>
                                    <div class="col-lg-6">
                                        <p:inputText class="form-control" value="#{detailDemandeMb.dese}"/>
                                    </div>
                                </div>
                            </div>

                            <div class="col-lg-12">
                                <br/>
                                <div class="pull-right">
                                    <p:commandButton onstart="PF('blockDialog1').show()" oncomplete="PF('blockDialog1').hide()"
                                                     value ="Rechercher" action="#{detailDemandeMb.enginByFam()}"
                                                     update=":dialog1:idEngin,:form:msgsRe"/>
                                </div>
                            </div>

                            <div class="col-lg-12">
                                <br/>
                                <p:dataTable id="idEngin" var="Eng" value="#{detailDemandeMb.listEngin}" rowKey="#{Eng.IDEngin}"
                                             paginator="true" rows="10"  rowsPerPageTemplate="5,10,15"
                                             paginatorTemplate="{RowsPerPageDropdown} {FirstPageLink} {PreviousPageLink} {CurrentPageReport} {NextPageLink} {LastPageLink}"
                                             paginatorPosition="bottom" class="table table-bordered" >
                                    <p:column headerText="Code Engin" filterBy="#{Eng.code}" filterFunction="#{filterMb.filterByX}">
                                        <h:outputText value="#{Eng.code}"/>
                                    </p:column>

                                    <p:column headerText="Désignation" filterBy="#{Eng.code}" filterFunction="#{filterMb.filterByX}">
                                        <h:outputText value="#{Eng.designation}"/>
                                    </p:column>

                                    <p:column headerText="Actions">
                                        <p:commandButton value="OK" update=":addArti,:addArti1,:detailDA"
                                                         onstart="PF('blockDialog1').show();" 
                                                         oncomplete="PF('blockDialog1').hide();PF('search1').hide()" >
                                            <f:setPropertyActionListener value="#{Eng}" target="#{detailDemandeMb.engin}" />
                                        </p:commandButton>
                                    </p:column>
                                </p:dataTable>
                            </div>  
                        </h:form>                         
                    </p:panel>
                </p:dialog>
                
                
                
                <script type="text/javascript">
                    $('.ui-inputfield').addClass('form-control');
                </script>
                <br/>
                <br/>
                <div class="col-lg-offset-10 col-lg-2">
                    <a href="dmdInterne.xhtml?faces-redirect=true" class="btn btn-default">Retour</a>
                </div>

            </ui:define>
        </ui:composition>
    </h:body>
</html>

